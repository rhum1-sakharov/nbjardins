<div class="mg-t-10">
  <div class="p-grid">
    <div class="p-col">
      <p-accordion [multiple]="false">
        <p-accordionTab header="Identification" [selected]="true">

          <div class="p-field p-grid">
            <label for="siret" class="p-col-fixed" style="width:100px"><strong>SIRET</strong></label>
            <div class="p-col">
              <input type="text" id="siret" [style]="{'width':'450px'}" pInputText [(ngModel)]="selectedSiret"/>
            </div>
          </div>

          <div class="p-field p-grid">
            <label for="societe" class="p-col-fixed" style="width:100px"><strong>Société</strong></label>
            <div class="p-col">
              <input type="text" id="societe" [style]="{'width':'450px'}" pInputText [(ngModel)]="selectedSociete"/>
            </div>
          </div>

          <div class="p-field p-grid">
            <label for="fonction" class="p-col-fixed" style="width:100px"><strong>Fonction</strong></label>
            <div class="p-col">
              <input type="text" id="fonction" [style]="{'width':'450px'}" pInputText [(ngModel)]="selectedFonction"/>
            </div>
          </div>


          <div class="p-field p-grid">
            <label for="adresse" class="p-col-fixed" style="width:100px"><strong>Adresse</strong></label>
            <div class="p-col">
              <input type="text" id="adresse" [style]="{'width':'450px'}" pInputText [(ngModel)]="selectedAdresse"/>
            </div>
          </div>

          <div class="p-field p-grid">
            <label for="ville" class="p-col-fixed" style="width:100px"><strong>Ville</strong></label>
            <div class="p-col">
              <input type="text" id="ville" [style]="{'width':'450px'}" pInputText [(ngModel)]="selectedVille"/>
            </div>
          </div>

          <div class="p-field p-grid">
            <label for="codePostal" class="p-col-fixed" style="width:100px"><strong>Code postal</strong></label>
            <div class="p-col">
              <input type="text" id="codePostal" [style]="{'width':'450px'}" pInputText
                     [(ngModel)]="selectedCodePostal"/>
            </div>
          </div>

          <div class="p-field p-grid">
            <label for="telephone" class="p-col-fixed" style="width:100px"><strong>Téléphone</strong></label>
            <div class="p-col">
              <input type="text" id="telephone" [style]="{'width':'450px'}" pInputText [(ngModel)]="selectedTelephone"/>
            </div>
          </div>

          <div class="p-field p-grid">
            <label for="signature" class="p-col-fixed" style="width:100px"><strong>Signature</strong></label>
            <div class="p-col">
              <span id="signature">Signature à implémenter</span>
            </div>
          </div>
        </p-accordionTab>

        <p-accordionTab header="Devis">
          <div data-test="taxe">
            <h5>TVA</h5>
            <p-listbox [options]="taxes" [(ngModel)]="selectedTaxe" optionLabel="nom" [style]="{'width':'450px'}">
              <ng-template let-item pTemplate="item">
                <div class="p-d-flex wh-450">
                  <div class="p-mr-2">
                    {{item.nom}}
                  </div>
                  <div class="p-ml-auto">
                    <strong>{{item.taux | number:'1.2-2'}}%</strong>
                  </div>
                </div>

              </ng-template>
            </p-listbox>
          </div>
          <div data-test="conditionReglement">
            <h5>Condition de règlement</h5>
            <p-listbox [options]="conditionsReglements" [(ngModel)]="selectedConditionReglement" optionLabel="condition"
                       [style]="{'width':'320px'}">
            </p-listbox>
          </div>


          <div data-test="provision">
            <h5>Provision</h5>
            <p-inputNumber [(ngModel)]="selectedProvision" mode="decimal" [minFractionDigits]="2"
                           [maxFractionDigits]="2"></p-inputNumber>
            %
          </div>

          <div data-test="provision">
            <h5>Validité du devis en mois</h5>
            <p-inputNumber [(ngModel)]="selectedValiditeDevisMois" mode="decimal"></p-inputNumber>
          </div>

        </p-accordionTab>
        <p-accordionTab header="Factures">
          Nouvelle fonctionnalité à implémenter...
        </p-accordionTab>
      </p-accordion>
      <p-button icon="pi pi-save" pTooltip="Enregistrer les modifications" (onClick)="save()"></p-button>
    </div>
    <div class="p-col">
      <div class="p-grid devis-preview">
        <div class="p-col-6">

          <div>
            <img [src]="artisan.logo" height="40">
          </div>
          <div>
            {{selectedSociete}}
          </div>
          <div>
            {{selectedAdresse}}
          </div>
          <div>
            <span class="mg-r-5">{{selectedCodePostal}}</span>
            <span>{{selectedVille}}</span>
          </div>
          <div>
            <span class="mg-r-5">Tél :</span>
            <span>{{selectedTelephone}}</span>
          </div>
          <div>
            <span class="mg-r-5">Email : </span>
            <span>{{artisan.personne.email}}</span>
          </div>
          <div>
            <span class="mg-r-5">SIRET : </span>
            <span>{{selectedSiret}}</span>
          </div>

        </div>
        <div class="p-col-6">
          <div>
            <strong>Milou Tartenpion</strong>
          </div>
          <div>
            544 chemin de fontblanque
          </div>
          <div>
            84350 Mazan
          </div>
        </div>

        <div class="p-col-6">
          <strong>Devis n° 20201230-001-ABN</strong>
        </div>
        <div class="p-col-6">
          Elagage des arbres de la propriété du 544 chemin de fontblaqune à Mazan
        </div>

        <div class="p-col-6">
          <span class="mg-r-5">{{selectedVille}}</span>, le {{previewDate | date:'dd/MM/yyyy'}}
        </div>
        <div class="p-col-6">
        </div>

        <div class="p-col-12">
          <table style="width:100%">
            <thead>
            <tr>
              <th>Désignation</th>
              <th>Montant en euros</th>
            </tr>
            </thead>
            <tbody>
            <tr>
              <td>Modificatif de l'état descriptif</td>
              <td class="montant">550.25</td>
            </tr>
            <tr>
              <td>Attestation de surface loi carrez</td>
              <td class="montant">125.78</td>
            </tr>
            </tbody>
          </table>
        </div>

        <div class="p-col-6">
        </div>
        <div class="p-col-6">
          <table style="width:100%">
            <tbody>
            <tr>
              <td><strong>TOTAL HT</strong></td>
              <td class="montant"><strong>676.03</strong></td>
            </tr>
            <tr>
              <td>TOTAL TVA ({{selectedTaxe.taux}}%)</td>
              <td class="montant">{{676.03 * (selectedTaxe.taux/100) | number:'1.2-2'}}</td>
            </tr>
            <tr>
              <td><strong>TOTAL TTC</strong></td>
              <td class="montant"><strong>{{676.03 * (1+(selectedTaxe.taux/100 )) | number:'1.2-2'}}</strong></td>
            </tr>
            </tbody>
          </table>
        </div>

        <div class="p-col-12">
          <span class="mg-r-5">
            <strong>Conditions de réglement :</strong>
          </span>
          <span>{{selectedConditionReglement.condition}}</span>
        </div>

        <div class="p-col-12">
          <span class="mg-r-5">Règlement à l'ordre de : </span>
          <span class="mg-r-5">
            <strong>{{selectedSociete}}</strong>
          </span>
          <span class="mg-r-5">-</span>
          <span class="mg-r-5">{{selectedAdresse}}</span>
          <span class="mg-r-5">-</span>
          <span class="mg-r-5">{{selectedCodePostal}}</span>
          <span class="mg-r-5">{{selectedVille}}</span>
        </div>

        <div class="p-col-12">
          <span class="mg-r-5">RIB : </span>
          <span class="mg-r-5">{{artisanBanque?.rib}}</span>
        </div>


        <div class="p-col-12">
          <span class="mg-r-5">IBAN : </span>
          <span class="mg-r-5">{{artisanBanque?.iban}}</span>
        </div>


        <div class="p-col-12">
          <span class="mg-r-5">
            <strong>Devis valable {{selectedValiditeDevisMois}} mois.</strong>
          </span>
        </div>

        <div class="p-col-12">
          <span class="mg-r-5">
            Acceptation du devis accompagné d'une provision de
          </span>
          <span class="mg-r-5">
            {{selectedProvision}} %
          </span>
        </div>

        <div class="p-col-12">
          <span class="mg-r-5">
            Bon pour commande,
          </span>
        </div>

        <div class="p-col-12">
          <span class="mg-r-5">
            Le ...........................................
          </span>
        </div>

        <div class="p-col-6">
          <span class="mg-r-5">
           Signature et nom du signataire
          </span>
        </div>
        <div class="p-col-6">
          <span class="mg-r-5">
           TODO signature artisan
          </span>
        </div>

      </div>
    </div>
  </div>


</div>




